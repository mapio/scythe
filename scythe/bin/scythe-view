echo1 "Opening the results viewer"

restrict_path=''
while getopts ":r:" opt; do
  case $opt in
    r)

      restrict_path="$(realpath $OPTARG)"
      if [ ! -r "$restrict_path" ]; then
        echo "scythe: view: cannot read '$restrict_path' file." >&2
        exit 1
      fi
      ;;

    \?)
      echo "scythe: view: invalid option: -$OPTARG." >&2
      exit 1
      ;;
    :)
      echo "scythe: view: option -$OPTARG requires an argument." >&2
      exit 1
      ;;
  esac
done


echo2 "Extracting the last results"
if [ ! -z "$restrict_path" ]; then
    echo3 "Will restrict UIDs to the one in '$restrict_path'."
    st results -r "${HARVEST}.json" -s "$SCYTHE_EXAM_ID" -R "$restrict_path"
else
    st results -r "${HARVEST}.json" -s "$SCYTHE_EXAM_ID"
fi



echo2 "Opening the viewer"
sv results.json:"${HARVEST}.json"
